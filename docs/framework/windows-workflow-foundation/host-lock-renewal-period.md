---
title: ホストのロック更新時間
ms.date: 03/30/2017
ms.assetid: f8ba94fc-27e0-4d8e-8f85-50a6d2a3cd43
ms.openlocfilehash: 82073377353be6d4f8a7d0a343c31f2b49a2873f
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/26/2020
ms.locfileid: "96268197"
---
# <a name="host-lock-renewal-period"></a><span data-ttu-id="d583e-102">ホストのロック更新時間</span><span class="sxs-lookup"><span data-stu-id="d583e-102">Host Lock Renewal Period</span></span>

<span data-ttu-id="d583e-103">SQL Workflow Instance Store の " **ホストロック更新期間** " プロパティでは、ホストがワークフローインスタンスのロックを更新する期間を指定できます。</span><span class="sxs-lookup"><span data-stu-id="d583e-103">The **Host Lock Renewal Period** property of the SQL Workflow Instance Store lets you specify the time period within which the host renews its lock on a workflow instance.</span></span> <span data-ttu-id="d583e-104">ロックは、ホストのロック更新時間 + 30 秒の間は有効です。</span><span class="sxs-lookup"><span data-stu-id="d583e-104">The lock remains valid for Host Lock Renewal Period + 30 seconds.</span></span> <span data-ttu-id="d583e-105">この期間内にホストがロックの更新 (つまり、リースを延長) に失敗した場合は、ロックの有効期限が切れ、永続化プロバイダーはインスタンスのロックを解除します。</span><span class="sxs-lookup"><span data-stu-id="d583e-105">If the host fails to renew the lock (in other words, extend the lease) within this time period, the lock expires and the persistence provider unlocks the instance.</span></span> <span data-ttu-id="d583e-106">このプロパティの値の型は、"hh: mm: ss" の形式の TimeSpan です。</span><span class="sxs-lookup"><span data-stu-id="d583e-106">The value for this property is of type TimeSpan of the form "hh:mm:ss".</span></span> <span data-ttu-id="d583e-107">許容される最小値は "00:00:01" (1 秒) です。</span><span class="sxs-lookup"><span data-stu-id="d583e-107">The minimum permitted value is "00:00:01" (1 second).</span></span> <span data-ttu-id="d583e-108">このプロパティの既定値は "00:00:30" (30 秒) です。</span><span class="sxs-lookup"><span data-stu-id="d583e-108">The default value of this property is "00:00:30" (30 seconds).</span></span>  
  
 <span data-ttu-id="d583e-109">このプロパティは、所有するワークフロー サービス インスタンスのロックを解除する前にワークフロー サービス ホストがエラーになった場合に重要です。</span><span class="sxs-lookup"><span data-stu-id="d583e-109">This property is significant in scenarios where a workflow service host fails before it can unlock a workflow service instance that it owns.</span></span> <span data-ttu-id="d583e-110">このような場合、ロックの有効期限が切れた後に永続プロバイダーによって永続性データベースのワークフロー サービス インスタンスのロックが削除され、サーバー ファーム内の同じコンピューターまたは別のコンピューターで実行されている別のワークフロー サービスホストがロックを取得してメモリにワークフロー サービス インスタンスを読み込み、最後の永続化状態から実行を再開できるようにします。</span><span class="sxs-lookup"><span data-stu-id="d583e-110">In this scenario, the lock on the workflow service instance in the persistence database is removed by the persistence provider after the lock expires so that another workflow service host running on the same computer or another computer in a server farm can acquire the lock and load the workflow service instance into memory to resume its execution from its last persisted state.</span></span>  
  
 <span data-ttu-id="d583e-111">このプロパティに大きな値を設定すると、ワークフロー サービス インスタンスが永続性データベースで長時間ロックされ、最後の永続性ポイントからインスタンスが回復するのが遅くなります。</span><span class="sxs-lookup"><span data-stu-id="d583e-111">Setting a higher value for this property causes the workflow service instances to be locked in the persistence database for a longer time and therefore delays the recovery of the instance from the last persistence point.</span></span> <span data-ttu-id="d583e-112">このプロパティに短い間隔を設定すると、ワークフロー サービス ホストの新しいインスタンスがすぐにエラーになったワークフロー サービス インスタンスを取得することになりますが、これによってワークフロー サービス ホストと SQL Server データベースの負荷が増加します。</span><span class="sxs-lookup"><span data-stu-id="d583e-112">Setting a short interval for this property causes the new instance of the workflow service host to pick up the failed workflow service instance quickly, but causes an increase in workload for the workflow service host and the SQL Server database.</span></span>  
  
 <span data-ttu-id="d583e-113">SQL Workflow Instance Store が実行する内部タスクは、定期的にアクティブになり、有効期限切れのロックを持つインスタンスを検出します。</span><span class="sxs-lookup"><span data-stu-id="d583e-113">The SQL Workflow Instance Store runs an internal task that periodically wakes up and detects instances with expired locks on them.</span></span> <span data-ttu-id="d583e-114">有効期限切れのロックを持つインスタンスが見つかると、そのインスタンスを RunnableInstances テーブルに置き、ワークフロー ホストがそのインスタンスを取得して実行できるようにします。</span><span class="sxs-lookup"><span data-stu-id="d583e-114">When it finds instances with expired locks, it places the instances in the RunnableInstances table so that a workflow host can pick up and run these instances.</span></span>
